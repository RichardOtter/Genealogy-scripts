Research for converting Fam type facts to individual shared facts


FactTypeTable

not all family type events have (fam) in name
They all have OwnerType =1

take one say Census (family)

FactTypeTable
FactTypeID=311
OwnerType=1


SELECT Name 
from FactTypeTable
where OwnerType = 1;


SELECT Count(*)
from EventTable et
Where 
et.EventType = 311
and
et.OwnerType = 1

Let's look at census record for
Kenji Imai RM:447
he is primary

His family is with 
Tsuya Fujimoto  448

FamilyTable
FatherID	MotherID
447			448			gives 
FamilyID=272

In EventTable
OwnerID=272
EventType=311
OwnerType=1			means OwnerID points to a FamilyID

gives 2 records that correspond to dates 1930 and 1940

1930 has 5 shares
1940 has 8 shares

consider the 1940 date
That is
EventID=16655
It has a place and a place detail (the 1940 has no place detail so it's SiteID= -1

look at WitnessTable 
for 
EventID=16655
get 8 records
The WitnessID point to PersonTable PersonID


So to convert this to an individual fact-
What is the current FactTypeID		311
What is the desired FactTypeID		18

first figure out the family the fact is currently attached to.  
Get the father ID number		447
Get the mother ID number	448
search family Table for this combo.  If more than one. STOP and think
get FamilyID=227

In Event Table, search for
OwnerID=272
EventType=311
OwnerType=1			OwnerID points to a FamilyID

get EventID=16655
there may be more than 1 event
make a list

for first in list
update EventTable where EventID=16655
EventType=18
OwnerType=0
OwnerID=447
FamilyID=0		currently always 0 ??? what is thi column for?

now must add the mother as a Witness
in WitnessTable
add new row
WitnessID  ++
EventID=16655
PersonID=448
WitnessOrder=0
Role=  175			this is a role for factType 18.  ????
175
new 927

=====================================
new example

for  eventID=14525
points to FamilyID=666

familyID=666 has fatherID=1685,  motherID=1683, child ID=4648
get father and mother, make fact owner=father and add mother to witness


927 last witness
==============================

FactTypeID		Name
311				Census (family)
				Residence (fam)
