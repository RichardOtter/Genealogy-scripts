REINDEX RMNOCASE;


UPDATE URLTable
SET Name = 'otter-saito'
WHERE Name = 'ott';

UPDATE URLTable
SET Name = 'lumsden-horn'
WHERE Name = 'lums';

UPDATE URLTable
SET Name = 'felton-tsujimoto'
WHERE Name = 'felton';

UPDATE NameTable
   SET
   Surname = TRIM(Surname),
   Given = TRIM(Given),
   Suffix = TRIM(Suffix),
   Prefix = TRIM(Prefix)
   WHERE 
         Surname <> TRIM(Surname)
     OR  Given   <> TRIM(Given)
     OR  Suffix  <> TRIM(Suffix)
     OR  Prefix  <> TRIM(Prefix);

UPDATE EventTable
   SET
   Details = TRIM(Details)
   WHERE 
         Details <> TRIM(Details);


--===========================================DIV50==
--Evidence-Summary or ChildParent count >1

SELECT PersonTable.PersonID, NameTable.Surname, NameTable.Given, FactTypeTable.Name, COUNT(*)
FROM PersonTable
INNER JOIN NameTable ON NameTable.OwnerID = PersonTable.PersonID
INNER JOIN EventTable ON EventTable.OwnerID = PersonTable.PersonID
INNER JOIN FactTypeTable ON FactTypeTable.FactTypeID = EventTable.EventType
WHERE NameTable.IsPrimary = 1
AND (FactTypeTable.Name = 'Evidence-Summary' OR FactTypeTable.Name = 'ChildParent')
GROUP BY PersonTable.PersonID, FactTypeTable.FactTypeID
HAVING COUNT(*) >1
